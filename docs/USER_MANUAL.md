# 学生请假管理系统 - 用户手册

## 目录
- [系统概述](#系统概述)
- [快速入门](#快速入门)
- [管理员操作指南](#管理员操作指南)
- [教师操作指南](#教师操作指南)
- [班主任操作指南](#班主任操作指南)
- [常见问题](#常见问题)

## 系统概述

学生请假管理系统是一套完整的学校请假管理解决方案，支持：
- 学生档案管理
- 请假申请与审核
- 自动退费计算
- 数据统计与导出

### 角色说明

| 角色 | 权限描述 |
|-----|---------|
| **超级管理员** | 拥有所有功能权限，包括用户管理、系统配置等 |
| **管理员** | 用户管理、基础设置、请假审核、数据导入导出、系统备份 |
| **教师** | 学生请假申请、查看自己的请假记录 |
| **班主任** | 查看本班学生信息、查看本班请假记录 |

## 快速入门

### 首次登录

1. 访问系统地址（如 http://localhost:3000）
2. 使用默认管理员账号登录：
   - 用户名: `admin`
   - 密码: `admin123`
3. 首次登录后，**立即修改密码**！

### 修改密码

1. 点击右上角用户名
2. 选择"修改密码"
3. 输入原密码和新密码
4. 点击"确定"

### 设置基础数据

首次使用前，需要配置以下基础数据：

1. **创建学期**: 系统设置 → 学期管理 → 新建学期
2. **创建年级**: 系统设置 → 年级管理 → 新建年级
3. **创建班级**: 系统设置 → 班级管理 → 新建班级
4. **导入学生**: 学生管理 → 批量导入

## 管理员操作指南

### 用户管理

#### 创建用户

1. 进入"用户管理"页面
2. 点击"新建用户"按钮
3. 填写用户信息：
   - 用户名（登录账号）
   - 密码
   - 真实姓名
   - 角色（管理员/教师/班主任）
   - 手机号（可选）
   - 邮箱（可选）
4. 点击"保存"

#### 分配班主任

1. 进入"班级管理"页面
2. 编辑班级
3. 选择"班主任"
4. 保存

### 学期管理

#### 创建学期

1. 进入"学期管理"页面
2. 点击"新建学期"
3. 填写信息：
   - 学期名称（如"2024-2025第一学期"）
   - 开始日期
   - 结束日期
   - 在校天数（用于计算每日退费金额）
4. 勾选"设为当前学期"（如需要）
5. 保存

#### 切换当前学期

在学期列表中，点击"设为当前学期"按钮。

### 班级管理

#### 创建班级

1. 进入"班级管理"页面
2. 点击"新建班级"
3. 选择所属学期和年级
4. 填写班级名称（如"1班"）
5. 设置伙食费标准（元/学期）
6. 选择班主任（可选）
7. 保存

### 学生管理

#### 添加单个学生

1. 进入"学生管理"页面
2. 点击"新建学生"
3. 填写学生信息：
   - 学号（必填，唯一）
   - 姓名
   - 性别
   - 所属班级
   - 出生日期
   - 家长姓名
   - 家长电话
   - 家庭住址
   - 是否营养餐（勾选后请假不退费）
4. 保存

#### 批量导入学生

1. 准备 Excel 文件，按模板格式填写
2. 进入"学生管理"页面
3. 点击"批量导入"
4. 下载模板文件
5. 填写学生数据
6. 上传文件
7. 系统自动导入并显示结果

**导入模板字段**：
- 学号（必填）
- 姓名（必填）
- 性别
- 班级（格式：年级名-班级名，如"一年级-1班"）
- 出生日期
- 家长姓名
- 家长电话
- 家庭住址
- 是否营养餐（是/否）

### 请假审核

#### 审核流程

1. 进入"请假管理" → "待审核"页面
2. 查看待审核列表
3. 点击"查看详情"
4. 审核请假信息：
   - 学生信息
   - 请假时间
   - 请假天数（系统自动计算）
   - 请假原因
   - 是否退费（营养餐学生不退费）
   - 退费金额（系统自动计算）
5. 选择操作：
   - **批准**: 填写审核备注，点击"批准"
   - **拒绝**: 填写拒绝原因，点击"拒绝"

#### 批量审核

在待审核列表中，可以勾选多条记录进行批量操作。

### 退费管理

#### 查看退费统计

1. 进入"退费管理" → "退费统计"页面
2. 选择学期
3. 查看统计数据：
   - 总退费金额
   - 各班级退费金额
   - 学生退费明细

#### 导出退费清单

1. 进入"退费管理" → "退费导出"页面
2. 选择学期
3. 选择导出格式（Excel）
4. 点击"导出"

### 数据备份

#### 手动备份

1. 进入"数据备份"页面
2. 点击"创建备份"
3. 选择备份内容：
   - 学生信息
   - 请假记录
   - 系统配置
   - 全部数据
4. 输入备份名称
5. 点击"创建"
6. 等待备份完成，可下载备份文件

#### 自动备份配置

1. 进入"数据备份" → "备份配置"页面
2. 启用自动备份
3. 设置：
   - 备份频率（每天/每周/每月）
   - 备份时间
   - 备份类型
   - 保留天数（建议 30 天）
4. 保存

### 恢复数据

⚠️ **警告**: 恢复数据会覆盖现有数据，建议先备份！

1. 进入"数据备份"页面
2. 在备份列表中选择要恢复的备份
3. 点击"恢复"
4. 确认操作
5. 等待恢复完成

### 系统设置

#### 请假相关配置

1. 进入"系统设置"页面
2. 配置请假参数：
   - **最小请假天数**: 设置学生最少请几天假（默认1天）
   - **补请假天数限制**: 设置允许补请请假的天数（0表示禁止补请假）
   - **教师请假申请开关**: 启用后教师可以提交请假申请，禁用后只能由管理员或班主任提交
   - **需要审批**: 启用后请假申请需要管理员审批
3. 点击"保存"

#### 系统参数配置

- **会话超时时间**: 设置用户登录会话的有效期（小时）
- **导出限制**: 设置单次导出的最大数据条数
- **维护模式**: 启用后系统进入维护状态，普通用户无法访问

### 通知管理

#### 发送通知给班主任

1. 进入"通知管理" → "发送通知"页面
2. 填写通知信息：
   - **标题**（必填）：通知的标题
   - **内容**（必填）：通知的详细内容
   - **类型**：选择通知类型
     - 系统通知（system）
     - 公告通知（announcement）
     - 提醒通知（reminder）
     - 警告通知（warning）
   - **接收人**：可选择多个班主任
3. 点击"发送"按钮
4. 系统自动为每个选中的班主任创建通知

#### 查看已发送通知

1. 进入"通知管理" → "已发送"页面
2. 查看批量发送的通知聚合显示
3. 可查看：
   - 通知标题和内容
   - 接收人数
   - 已读人数
   - 展开查看每个接收人的阅读状态
4. 点击通知卡片可展开/收起详情

#### 管理接收的通知

1. 进入"通知管理" → "我的通知"页面
2. 查看接收的通知列表
3. 点击通知卡片展开详情（**自动标记已读**）
4. 可操作：
   - 标记已读/未读
   - 删除通知
   - 全部标记已读
   - 清理已读通知

#### 通知统计

在通知页面可以看到：
- 总通知数
- 未读通知数
- 按类型分组的统计

#### 清理通知

1. 进入"通知管理"页面
2. 点击"清理已读"按钮
3. 系统会删除所有已读通知
4. 注意：此操作不可恢复

### 数据库管理

⚠️ **注意**: 数据库管理功能仅供高级管理员使用，普通管理员无权访问。

#### 查看数据库连接

1. 进入"系统设置" → "数据库管理"页面
2. 查看所有数据库连接列表
3. 可查看：
   - 连接名称
   - 环境类型（生产/测试/开发）
   - 是否为当前活动连接
   - 连接测试状态
   - 最后切换时间

#### 创建数据库连接

1. 进入"数据库管理"页面
2. 点击"新建连接"按钮
3. 填写连接信息：
   - **连接名称**（必填）：如"生产库"、"测试库"
   - **环境类型**：选择环境类型
   - **主机地址**（必填）：数据库服务器地址
   - **端口**（必填）：默认 5432
   - **数据库名**（必填）：数据库名称
   - **用户名**（必填）：数据库用户名
   - **密码**（必填）：数据库密码（加密存储）
   - **描述**（可选）：连接说明
4. 点击"测试连接"验证配置
5. 测试通过后点击"保存"

#### 测试数据库连接

1. 在数据库列表中找到要测试的连接
2. 点击"测试连接"按钮
3. 系统会显示连接状态：
   - ✅ 连接成功
   - ❌ 连接失败（显示错误信息）

#### 切换数据库

⚠️ **警告**: 切换数据库会更改系统使用的数据库，请谨慎操作！

1. 在数据库列表中找到目标连接
2. 点击"切换到此数据库"按钮
3. 确认切换操作
4. 系统会：
   - 记录切换历史
   - 验证目标数据库表结构
   - 自动创建缺失的表（如需要）
   - 更新活动连接

#### 查看切换历史

1. 进入"数据库管理" → "切换历史"页面
2. 查看所有数据库切换记录
3. 可查看：
   - 切换时间
   - 源数据库
   - 目标数据库
   - 操作人

#### 编辑数据库连接

1. 在数据库列表中找到要编辑的连接
2. 点击"编辑"按钮
3. 修改连接信息
4. 保存修改

#### 删除数据库连接

⚠️ **注意**: 不能删除当前正在使用的数据库连接。

1. 在数据库列表中找到要删除的连接
2. 确保该连接不是当前活动连接
3. 点击"删除"按钮
4. 确认删除

## 教师操作指南

### 申请请假

1. 进入"请假管理" → "申请请假"页面
2. 填写请假信息：
   - 选择学生
   - 选择学期（自动显示当前学期）
   - 开始日期
   - 结束日期
   - 请假原因
3. 系统自动计算：
   - 请假天数（包含周末）
   - 是否可退费
   - 退费金额
4. 点击"提交申请"

### 查看请假记录

1. 进入"我的请假"页面
2. 查看请假列表
3. 可筛选：
   - 状态（全部/待审核/已批准/已拒绝）
   - 学期
   - 学生
4. 点击"查看详情"查看详细信息

### 修改请假申请

仅待审核状态可修改：
1. 在请假列表中找到申请
2. 点击"编辑"
3. 修改信息
4. 重新提交

### 撤销申请

仅待审核状态可撤销：
1. 在请假列表中找到申请
2. 点击"撤销"
3. 确认操作

## 班主任操作指南

### 查看本班学生

1. 进入"我的学生"页面
2. 系统自动显示本班所有学生
3. 可查看：
   - 学生基本信息
   - 请假记录
   - 退费情况

### 查看班级请假

1. 进入"班级请假"页面
2. 查看本班所有请假记录
3. 可筛选：
   - 状态
   - 时间范围
   - 学生

### 查看统计数据

在班主任首页可以看到：
- 班级学生总数
- 本学期请假人数
- 本学期请假总天数
- 本学期退费总额

## 常见问题

### Q1: 忘记密码怎么办？

请联系管理员重置密码。管理员可以在"用户管理"中重置用户密码。

### Q2: 请假天数如何计算？

系统自动计算从开始日期到结束日期的所有天数（包含周末和节假日）。例如：
- 开始日期：2024-01-10
- 结束日期：2024-01-12
- 请假天数：3 天

### Q3: 退费金额如何计算？

计算公式：
```
每日退费金额 = 班级伙食费标准 / 学期在校天数
退费金额 = 请假天数 × 每日退费金额
```

示例：
- 班级伙食费：1000 元/学期
- 学期在校天数：100 天
- 请假天数：3 天
- 退费金额：3 × (1000 / 100) = 30 元

### Q4: 为什么某些学生不退费？

如果学生被标记为"营养餐"学生，请假时不退费。这是系统规则，营养餐由国家财政补贴，不需要退费。

### Q5: 如何批量导入学生失败？

常见原因：
1. Excel 格式不正确 → 使用系统提供的模板
2. 必填字段为空 → 检查学号、姓名、班级是否填写
3. 班级不存在 → 先创建对应的年级和班级
4. 学号重复 → 检查是否有重复学号

### Q6: 如何修改已批准的请假？

已批准的请假记录不能直接修改。如需修改，请：
1. 先拒绝该请假记录
2. 重新申请

或联系管理员在数据库层面修改（不推荐）。

### Q7: 数据丢失怎么办？

如果数据丢失，可以：
1. 进入"数据备份"页面
2. 选择最近的备份文件
3. 点击"恢复"

建议定期备份数据！

### Q8: 系统支持导出哪些数据？

支持导出：
- 学生信息（Excel）
- 请假记录（Excel）
- 退费清单（Excel）
- 用户列表（Excel）
- 统计报表（Excel）

### Q9: 如何切换学期？

管理员可以：
1. 进入"学期管理"页面
2. 点击对应学期的"设为当前学期"按钮

普通用户无需手动切换，系统默认使用当前学期。

### Q10: 请假申请提交后多久审核？

审核时间由管理员决定。建议在 1 个工作日内完成审核。教师可以在"我的请假"页面查看审核状态。

### Q11: 通知发送后班主任收不到？

可能原因：
1. 班主任账号未正确分配 → 检查班级管理中的班主任设置
2. 班主任账号未激活 → 检查用户管理中的账号状态
3. 通知被过滤 → 检查通知类型和权限设置

### Q12: 如何批量清理已读通知？

在通知页面，点击"清理已读"按钮，系统会删除所有已读通知。

### Q13: 数据库切换失败怎么办？

常见原因：
1. 目标数据库连接失败 → 检查网络和数据库服务状态
2. 表结构不一致 → 系统会自动尝试创建表，查看错误日志
3. 权限不足 → 确保数据库用户有足够权限

### Q14: 切换数据库后数据丢失？

数据库切换是切换到不同的数据库实例，不是数据同步。
- 切换前请确保目标数据库有需要的数据
- 建议使用数据迁移功能同步数据
- 定期备份各数据库

## 系统快捷键

| 快捷键 | 功能 |
|-------|------|
| Ctrl + K | 搜索（全局搜索） |
| Ctrl + N | 新建（当前页面） |
| Ctrl + S | 保存（表单页面） |
| ESC | 关闭对话框 |

## 浏览器兼容性

推荐使用以下浏览器：
- Chrome 90+
- Firefox 88+
- Edge 90+
- Safari 14+

## 技术支持

如有其他问题，请联系：
- 技术支持电话：XXX-XXXXXXXX
- 技术支持邮箱：support@example.com
- 在线帮助：访问系统帮助文档

---

**版本**: v1.0.0
**更新日期**: 2025-12-31
